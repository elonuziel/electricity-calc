<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××—×©×‘×•×Ÿ ×—×©××œ ×“×™×™×¨×™× (××•×¤×œ×™×™×Ÿ)</title>
    <style>
        /* â”€â”€â”€â”€â”€ Reset & Base â”€â”€â”€â”€â”€ */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
            line-height: 1.5;
            padding-bottom: 5rem;
            -webkit-text-size-adjust: 100%;
        }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            opacity: 1;
        }

        button {
            cursor: pointer;
            border: none;
            font-family: inherit;
        }

        input {
            font-family: inherit;
        }

        /* â”€â”€â”€â”€â”€ Layout â”€â”€â”€â”€â”€ */
        .container {
            max-width: 48rem;
            margin: 0 auto;
            padding: 1rem;
        }

        .container-sm {
            max-width: 32rem;
            margin: 0 auto;
        }

        /* â”€â”€â”€â”€â”€ Typography â”€â”€â”€â”€â”€ */
        .text-xs {
            font-size: 0.75rem;
            line-height: 1rem;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .text-base {
            font-size: 1rem;
        }

        .text-lg {
            font-size: 1.125rem;
            line-height: 1.75rem;
        }

        .text-xl {
            font-size: 1.25rem;
            line-height: 1.75rem;
        }

        .text-2xl {
            font-size: 1.5rem;
            line-height: 2rem;
        }

        .text-3xl {
            font-size: 1.875rem;
            line-height: 2.25rem;
        }

        .text-4xl {
            font-size: 2.25rem;
            line-height: 2.5rem;
        }

        .font-bold {
            font-weight: 700;
        }

        .font-medium {
            font-weight: 500;
        }

        .text-center {
            text-align: center;
        }

        /* â”€â”€â”€â”€â”€ Colors (text) â”€â”€â”€â”€â”€ */
        .text-white {
            color: #fff;
        }

        .text-gray-400 {
            color: #9ca3af;
        }

        .text-gray-500 {
            color: #6b7280;
        }

        .text-gray-600 {
            color: #4b5563;
        }

        .text-gray-700 {
            color: #374151;
        }

        .text-gray-800 {
            color: #1f2937;
        }

        .text-blue-200 {
            color: #bfdbfe;
        }

        .text-blue-500 {
            color: #3b82f6;
        }

        .text-blue-600 {
            color: #2563eb;
        }

        .text-blue-700 {
            color: #1d4ed8;
        }

        .text-blue-800 {
            color: #1e40af;
        }

        .text-green-600 {
            color: #16a34a;
        }

        .text-green-700 {
            color: #15803d;
        }

        .text-green-800 {
            color: #166534;
        }

        .text-red-400 {
            color: #f87171;
        }

        .text-red-600 {
            color: #dc2626;
        }

        .text-red-700 {
            color: #b91c1c;
        }

        .text-red-800 {
            color: #991b1b;
        }

        .text-orange-500 {
            color: #f97316;
        }

        .text-orange-600 {
            color: #ea580c;
        }

        .text-orange-800 {
            color: #9a3412;
        }

        .text-yellow-800 {
            color: #854d0e;
        }

        .text-yellow-700 {
            color: #a16207;
        }

        .border-yellow-300 {
            border-color: #fde047;
        }

        /* â”€â”€â”€â”€â”€ Colors (background) â”€â”€â”€â”€â”€ */
        .bg-white {
            background-color: #fff;
        }

        .bg-gray-50 {
            background-color: #f9fafb;
        }

        .bg-gray-100 {
            background-color: #f3f4f6;
        }

        .bg-gray-600 {
            background-color: #4b5563;
        }

        .bg-blue-50 {
            background-color: #eff6ff;
        }

        .bg-blue-600 {
            background-color: #2563eb;
        }

        .bg-green-50 {
            background-color: #f0fdf4;
        }

        .bg-green-600 {
            background-color: #16a34a;
        }

        .bg-red-50 {
            background-color: #fef2f2;
        }

        .bg-red-600 {
            background-color: #dc2626;
        }

        .bg-orange-50 {
            background-color: #fff7ed;
        }

        .bg-orange-500 {
            background-color: #f97316;
        }

        .bg-orange-600 {
            background-color: #ea580c;
        }

        .bg-yellow-50 {
            background-color: #fefce8;
        }

        /* â”€â”€â”€â”€â”€ Spacing â”€â”€â”€â”€â”€ */
        .p-2 {
            padding: 0.5rem;
        }

        .p-3 {
            padding: 0.75rem;
        }

        .p-4 {
            padding: 1rem;
        }

        .p-5 {
            padding: 1.25rem;
        }

        .px-2 {
            padding-left: 0.5rem;
            padding-right: 0.5rem;
        }

        .px-4 {
            padding-left: 1rem;
            padding-right: 1rem;
        }

        .py-1 {
            padding-top: 0.25rem;
            padding-bottom: 0.25rem;
        }

        .py-2 {
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }

        .py-3 {
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
        }

        .py-10 {
            padding-top: 2.5rem;
            padding-bottom: 2.5rem;
        }

        .pr-3 {
            padding-right: 0.75rem;
        }

        .pt-2 {
            padding-top: 0.5rem;
        }

        .pt-4 {
            padding-top: 1rem;
        }

        .pb-1 {
            padding-bottom: 0.25rem;
        }

        .pb-2 {
            padding-bottom: 0.5rem;
        }

        .mb-1 {
            margin-bottom: 0.25rem;
        }

        .mb-2 {
            margin-bottom: 0.5rem;
        }

        .mb-3 {
            margin-bottom: 0.75rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .mb-6 {
            margin-bottom: 1.5rem;
        }

        .ml-2 {
            margin-left: 0.5rem;
        }

        .mt-1 {
            margin-top: 0.25rem;
        }

        .mt-2 {
            margin-top: 0.5rem;
        }

        .mt-3 {
            margin-top: 0.75rem;
        }

        /* â”€â”€â”€â”€â”€ Borders â”€â”€â”€â”€â”€ */
        .border {
            border: 1px solid #d1d5db;
        }

        .border-b {
            border-bottom: 1px solid #e5e7eb;
        }

        .border-t {
            border-top: 1px solid #e5e7eb;
        }

        .border-r {
            border-right: 1px solid #e5e7eb;
        }

        .border-l {
            border-left: 1px solid #e5e7eb;
        }

        .border-t-4 {
            border-top: 4px solid;
        }

        .border-t-4.border-gray-500 {
            border-top-color: #6b7280;
        }

        .border-gray-300 {
            border-color: #d1d5db;
        }

        .border-blue-100 {
            border-color: #dbeafe;
        }

        .border-blue-200 {
            border-color: #bfdbfe;
        }

        .border-green-100 {
            border-color: #dcfce7;
        }

        .border-green-200 {
            border-color: #bbf7d0;
        }

        .border-red-100 {
            border-color: #fee2e2;
        }

        .border-red-200 {
            border-color: #fecaca;
        }

        .border-red-300 {
            border-color: #fca5a5;
        }

        .border-orange-200 {
            border-color: #fed7aa;
        }

        .border-yellow-200 {
            border-color: #fef08a;
        }

        .bg-yellow-500 {
            background-color: #eab308;
        }

        .bg-yellow-600 {
            background-color: #ca8a04;
        }

        /* â”€â”€â”€â”€â”€ Rounded â”€â”€â”€â”€â”€ */
        .rounded {
            border-radius: 0.25rem;
        }

        .rounded-lg {
            border-radius: 0.5rem;
        }

        .rounded-xl {
            border-radius: 0.75rem;
        }

        .rounded-full {
            border-radius: 9999px;
        }

        .rounded-t-xl {
            border-top-left-radius: 0.75rem;
            border-top-right-radius: 0.75rem;
        }

        /* â”€â”€â”€â”€â”€ Shadows â”€â”€â”€â”€â”€ */
        .shadow-md {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -2px rgba(0, 0, 0, .1);
        }

        .shadow-lg {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, .1), 0 4px 6px -4px rgba(0, 0, 0, .1);
        }

        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -1px rgba(0, 0, 0, .06);
        }

        /* â”€â”€â”€â”€â”€ Flexbox â”€â”€â”€â”€â”€ */
        .flex {
            display: flex;
        }

        .flex-1 {
            flex: 1 1 0%;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-1 {
            gap: 0.25rem;
        }

        .gap-2 {
            gap: 0.5rem;
        }

        .gap-3 {
            gap: 0.75rem;
        }

        .gap-4 {
            gap: 1rem;
        }

        /* â”€â”€â”€â”€â”€ Grid â”€â”€â”€â”€â”€ */
        .grid {
            display: grid;
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .col-span-2 {
            grid-column: span 2 / span 2;
        }

        /* â”€â”€â”€â”€â”€ Width / Height â”€â”€â”€â”€â”€ */
        .w-full {
            width: 100%;
        }

        .max-w-lg {
            max-width: 32rem;
        }

        .max-w-md {
            max-width: 28rem;
        }

        .max-h-90vh {
            max-height: 90vh;
        }

        /* â”€â”€â”€â”€â”€ Overflow â”€â”€â”€â”€â”€ */
        .overflow-hidden {
            overflow: hidden;
        }

        .overflow-y-auto {
            overflow-y: auto;
        }

        /* â”€â”€â”€â”€â”€ Position â”€â”€â”€â”€â”€ */
        .relative {
            position: relative;
        }

        .absolute {
            position: absolute;
        }

        .sticky {
            position: sticky;
        }

        .fixed {
            position: fixed;
        }

        .top-0 {
            top: 0;
        }

        .inset-0 {
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        .neg-top-2 {
            top: -0.5rem;
        }

        .right-2 {
            right: 0.5rem;
        }

        .z-10 {
            z-index: 10;
        }

        .z-50 {
            z-index: 50;
        }

        /* â”€â”€â”€â”€â”€ Display â”€â”€â”€â”€â”€ */
        .hidden {
            display: none !important;
        }

        .block {
            display: block;
        }

        /* â”€â”€â”€â”€â”€ Misc â”€â”€â”€â”€â”€ */
        .transition {
            transition: all 0.15s ease;
        }

        .list-disc {
            list-style-type: disc;
        }

        .list-inside {
            list-style-position: inside;
        }

        /* space-y helper: vertical spacing between children */
        .space-y-1>*+* {
            margin-top: 0.25rem;
        }

        .space-y-3>*+* {
            margin-top: 0.75rem;
        }

        .space-y-4>*+* {
            margin-top: 1rem;
        }

        /* â”€â”€â”€â”€â”€ Header â”€â”€â”€â”€â”€ */
        header {
            background-color: #2563eb;
            color: #fff;
            padding: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, .1);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        header .inner {
            max-width: 48rem;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h1 {
            font-size: 1.25rem;
            font-weight: 700;
        }

        header button {
            background: none;
            color: #fff;
            font-size: 1.25rem;
        }

        header button:hover {
            color: #bfdbfe;
        }

        /* â”€â”€â”€â”€â”€ Buttons â”€â”€â”€â”€â”€ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            border-radius: 0.5rem;
            transition: background-color 0.15s ease;
        }

        .btn-blue {
            background-color: #2563eb;
            color: #fff;
        }

        .btn-blue:hover {
            background-color: #1d4ed8;
        }

        .btn-gray {
            background-color: #4b5563;
            color: #fff;
        }

        .btn-gray:hover {
            background-color: #374151;
        }

        .btn-green {
            background-color: #16a34a;
            color: #fff;
        }

        .btn-green:hover {
            background-color: #15803d;
        }

        .btn-orange {
            background-color: #f97316;
            color: #fff;
        }

        .btn-orange:hover {
            background-color: #ea580c;
        }

        /* â”€â”€â”€â”€â”€ Inputs â”€â”€â”€â”€â”€ */
        .input-field {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            font-family: inherit;
            outline: none;
        }

        .input-field:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
        }

        /* â”€â”€â”€â”€â”€ Modal Overlay â”€â”€â”€â”€â”€ */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            padding: 1rem;
        }

        .modal-content {
            background: #fff;
            border-radius: 0.75rem;
            width: 100%;
            max-width: 32rem;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* â”€â”€â”€â”€â”€ Bill Card â”€â”€â”€â”€â”€ */
        .bill-card {
            background: #fff;
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -1px rgba(0, 0, 0, .06);
        }

        .bill-card+.bill-card {
            margin-top: 1rem;
        }

        /* â”€â”€â”€â”€â”€ Tenant Mini-Card â”€â”€â”€â”€â”€ */
        .tenant-card {
            border: 1px solid;
            border-radius: 0.5rem;
            padding: 0.75rem;
            position: relative;
        }

        .tenant-label {
            position: absolute;
            top: -0.5rem;
            right: 0.5rem;
            color: #fff;
            font-size: 0.75rem;
            padding: 0.125rem 0.5rem;
            border-radius: 0.25rem;
        }

        /* â”€â”€â”€â”€â”€ Emoji icons (replace font-awesome) â”€â”€â”€â”€â”€ */
        .icon {
            font-style: normal;
        }

        /* â”€â”€â”€â”€â”€ Responsive â”€â”€â”€â”€â”€ */
        @media (min-width: 768px) {
            .md-grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        @media (max-width: 767px) {
            .md-grid-cols-2 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <!-- Header -->
    <header>
        <div class="inner">
            <h1>âš¡ ×—×©××œ ×“×™×™×¨×™×</h1>
            <button onclick="toggleSettings()" title="×”×’×“×¨×•×ª">âš™ï¸</button>
        </div>
    </header>

    <main class="container">

        <!-- Settings Panel (Hidden by default) -->
        <div id="settingsPanel" class="hidden"
            style="background:#fff; border-radius:0.5rem; padding:1rem; margin-bottom:1.5rem; border-top:4px solid #6b7280; box-shadow:0 4px 6px -1px rgba(0,0,0,.1);">
            <h2
                style="font-size:1.125rem; font-weight:700; margin-bottom:1rem; color:#374151; border-bottom:1px solid #e5e7eb; padding-bottom:0.5rem;">
                ×”×’×“×¨×•×ª</h2>

            <div style="margin-bottom:1.5rem;">
                <h3 style="font-weight:700; font-size:0.875rem; color:#4b5563; margin-bottom:0.5rem;">×§×¨×™××” ×¨××©×•× ×™×ª
                    (×”×ª×—×œ×ª×™×ª)</h3>
                <p style="font-size:0.75rem; color:#6b7280; margin-bottom:0.75rem;">×”××¡×¤×¨×™× ×©×”×™×• ×‘×©×¢×•× ×™× ×œ×¤× ×™ ×”×—×©×‘×•×Ÿ
                    ×”×¨××©×•×Ÿ.</p>
                <div class="grid md-grid-cols-2" style="gap:1rem; margin-bottom:1rem;">
                    <div>
                        <label
                            style="display:block; font-size:0.875rem; font-weight:500; color:#374151; margin-bottom:0.25rem;">×§×¨×™××”
                            ×”×ª×—×œ×ª×™×ª - ×¢×œ×™×•× ×”</label>
                        <input type="number" id="initReadingTop" class="input-field" placeholder="0">
                    </div>
                    <div>
                        <label
                            style="display:block; font-size:0.875rem; font-weight:500; color:#374151; margin-bottom:0.25rem;">×§×¨×™××”
                            ×”×ª×—×œ×ª×™×ª - ×ª×—×ª×•× ×”</label>
                        <input type="number" id="initReadingBottom" class="input-field" placeholder="0">
                    </div>
                </div>
                <button onclick="saveSettings()" class="btn btn-gray w-full"
                    style="padding:0.5rem 1rem; margin-bottom:1rem;">
                    ×©××•×¨ ×§×¨×™××•×ª ×”×ª×—×œ×ª×™×•×ª
                </button>
            </div>

            <div style="border-top:1px solid #e5e7eb; padding-top:1rem;" class="space-y-3">
                <h3 style="font-weight:700; font-size:0.875rem; color:#4b5563; margin-bottom:0.5rem;">×’×™×‘×•×™ × ×ª×•× ×™× /
                    ××™×¤×•×¡</h3>
                <button onclick="exportToCSV()" class="btn btn-green w-full" style="padding:0.5rem 1rem; gap:0.5rem;">
                    ğŸ“¤ ×™×™×¦×•× ×œ××§×¡×œ (CSV)
                </button>
                <button onclick="document.getElementById('csvFileInput').click()" class="btn btn-orange w-full"
                    style="padding:0.5rem 1rem; gap:0.5rem;">
                    ğŸ“¥ ×™×™×‘×•× ×××§×¡×œ (CSV)
                </button>
                <input type="file" id="csvFileInput" accept=".csv" class="hidden" onchange="importFromCSV(event)">
                <p style="font-size:0.75rem; color:#9ca3af; text-align:center;">×”×™×™×‘×•× ××¦×¤×” ×œ××•×ª×• ×¤×•×¨××˜ ×›××• ×”×™×™×¦×•×.
                    ×©×•×¨×•×ª ×›×¤×•×œ×•×ª (×œ×¤×™ ×ª××¨×™×š) ×™×“×œ×’×•.</p>

                <div style="margin-top:0.75rem; margin-bottom:0.75rem; border-top:1px solid #e5e7eb;"></div>

                <button onclick="resetAllData()" class="btn w-full"
                    style="background:#dc2626; color:#fff; padding:0.5rem 1rem; gap:0.5rem;">
                    ğŸ—‘ï¸ ××—×™×§×ª ×›×œ ×”× ×ª×•× ×™× (××™×¤×•×¡)
                </button>
            </div>
        </div>

        <!-- Initial Readings Banner -->
        <div id="initReadingsBanner" class="hidden"
            style="background:#fefce8; border:1px solid #fde047; border-radius:0.5rem; padding:1rem; margin-bottom:1.5rem; box-shadow:0 4px 6px -1px rgba(0,0,0,.1);">
            <div style="display:flex; align-items:center; gap:0.5rem; color:#854d0e; margin-bottom:0.25rem;">
                <span>âš ï¸</span>
                <span style="font-weight:700;">× ×“×¨×©×ª ×§×¨×™××” ×¨××©×•× ×™×ª</span>
            </div>
            <p style="font-size:0.875rem; color:#a16207;">×œ×¤× ×™ ×”×•×¡×¤×ª ×—×©×‘×•×Ÿ ×¨××©×•×Ÿ, ×™×© ×œ×”×–×™×Ÿ ××ª ×§×¨×™××•×ª ×”××•× ×™× ××”×—×•×“×©
                ×”×§×•×“×.</p>
        </div>

        <!-- Add New Bill Button -->
        <button onclick="openModal()" class="btn btn-blue w-full"
            style="padding:0.75rem; font-size:1rem; margin-bottom:1.5rem; box-shadow:0 4px 6px -1px rgba(0,0,0,.1);">
            â• ×”×•×¡×¤×ª ×—×©×‘×•×Ÿ ×—×“×©
        </button>

        <!-- Bills List -->
        <div id="billsList"></div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden" style="text-align:center; padding:2.5rem 0; color:#6b7280;">
            <div style="font-size:2.25rem; margin-bottom:0.75rem;">ğŸ“„</div>
            <p>××™×Ÿ ×¢×“×™×™×Ÿ ×—×©×‘×•× ×•×ª. ×œ×—×¦×™ ×¢×œ ×”×›×¤×ª×•×¨ ×œ××¢×œ×” ×œ×”×•×¡×¤×”.</p>
        </div>
    </main>

    <!-- Add/Edit Bill Modal -->
    <div id="billModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div
                style="padding:1.25rem; border-bottom:1px solid #e5e7eb; display:flex; justify-content:space-between; align-items:center; background:#eff6ff; border-radius:0.75rem 0.75rem 0 0;">
                <h2 id="modalTitle" style="font-size:1.25rem; font-weight:700; color:#1e40af;">×¤×¨×˜×™ ×—×©×‘×•×Ÿ ×—×“×©</h2>
                <button onclick="closeModal()"
                    style="background:none; color:#6b7280; font-size:1.5rem; line-height:1;">&times;</button>
            </div>

            <form id="billForm" onsubmit="handleFormSubmit(event)" style="padding:1.25rem;" class="space-y-4">

                <!-- Validation Errors -->
                <div id="formErrors" class="hidden"
                    style="background:#fef2f2; border:1px solid #fca5a5; color:#b91c1c; padding:0.75rem; border-radius:0.5rem; font-size:0.875rem;">
                    <ul id="formErrorList" class="list-disc list-inside space-y-1"></ul>
                </div>

                <!-- Main Bill Section -->
                <div style="background:#fef2f2; padding:0.75rem; border-radius:0.5rem; border:1px solid #fee2e2;">
                    <h3
                        style="font-weight:700; color:#991b1b; margin-bottom:0.5rem; border-bottom:1px solid #fecaca; padding-bottom:0.25rem;">
                        ğŸ§¾ ×—×©×‘×•×Ÿ ×›×œ×œ×™ (×¨××©×™)</h3>
                    <div class="grid grid-cols-2" style="gap:0.75rem;">
                        <div>
                            <label style="display:block; font-size:0.75rem; font-weight:700; color:#4b5563;">×ª××¨×™×š
                                ×”×—×©×‘×•×Ÿ</label>
                            <input type="date" id="billDate" required class="input-field">
                        </div>
                        <div>
                            <label style="display:block; font-size:0.75rem; font-weight:700; color:#4b5563;">×¡×”"×› ×œ×ª×©×œ×•×
                                (â‚ª)</label>
                            <input type="number" step="0.01" min="0.01" id="mainAmount" required class="input-field">
                        </div>
                        <div class="col-span-2">
                            <label style="display:block; font-size:0.75rem; font-weight:700; color:#4b5563;">×¡×”"×› ×¦×¨×™×›×”
                                (×§×•×˜"×©)</label>
                            <input type="number" step="1" min="1" id="mainKwh" required class="input-field">
                        </div>
                    </div>
                </div>

                <!-- Top Apartment -->
                <div style="background:#f0fdf4; padding:0.75rem; border-radius:0.5rem; border:1px solid #dcfce7;">
                    <h3
                        style="font-weight:700; color:#166534; margin-bottom:0.5rem; border-bottom:1px solid #bbf7d0; padding-bottom:0.25rem;">
                        ğŸ  ×“×™×¨×” ×¢×œ×™×•× ×”</h3>
                    <div>
                        <label style="display:block; font-size:0.75rem; font-weight:700; color:#4b5563;">×§×¨×™××ª ××•× ×”
                            × ×•×›×—×™×ª</label>
                        <input type="number" step="1" id="readingTop" required class="input-field">
                        <p style="font-size:0.75rem; color:#6b7280; margin-top:0.25rem;">×§×¨×™××” ×§×•×“××ª: <span
                                id="prevTopDisplay">0</span></p>
                    </div>
                </div>

                <!-- Bottom Apartment -->
                <div style="background:#eff6ff; padding:0.75rem; border-radius:0.5rem; border:1px solid #dbeafe;">
                    <h3
                        style="font-weight:700; color:#1e40af; margin-bottom:0.5rem; border-bottom:1px solid #bfdbfe; padding-bottom:0.25rem;">
                        ğŸ¢ ×“×™×¨×” ×ª×—×ª×•× ×”</h3>
                    <div>
                        <label style="display:block; font-size:0.75rem; font-weight:700; color:#4b5563;">×§×¨×™××ª ××•× ×”
                            × ×•×›×—×™×ª</label>
                        <input type="number" step="1" id="readingBottom" required class="input-field">
                        <p style="font-size:0.75rem; color:#6b7280; margin-top:0.25rem;">×§×¨×™××” ×§×•×“××ª: <span
                                id="prevBottomDisplay">0</span></p>
                    </div>
                </div>

                <div style="padding-top:0.5rem;">
                    <button type="submit" class="btn btn-blue w-full"
                        style="padding:0.75rem; font-size:1rem; box-shadow:0 4px 6px -1px rgba(0,0,0,.1);">
                        ×©××•×¨ ×•×—×©×‘
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Initial Readings Modal -->
    <div id="initReadingsModal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width:28rem;">
            <div
                style="padding:1.25rem; border-bottom:1px solid #e5e7eb; background:#fefce8; border-radius:0.75rem 0.75rem 0 0;">
                <h2
                    style="font-size:1.25rem; font-weight:700; color:#854d0e; display:flex; align-items:center; gap:0.5rem;">
                    ğŸ”¢ ×§×¨×™××•×ª ××•× ×™× ××”×—×•×“×© ×©×¢×‘×¨
                </h2>
                <p style="font-size:0.875rem; color:#a16207; margin-top:0.25rem;">×™×© ×œ×”×–×™×Ÿ ××ª ×”×§×¨×™××•×ª ×©×”×™×• ×‘×©×¢×•× ×™× ×œ×¤× ×™
                    ×”×—×©×‘×•×Ÿ ×”×¨××©×•×Ÿ.</p>
            </div>
            <form id="initReadingsForm" onsubmit="handleInitReadingsSubmit(event)" style="padding:1.25rem;"
                class="space-y-4">
                <div id="initFormErrors" class="hidden"
                    style="background:#fef2f2; border:1px solid #fca5a5; color:#b91c1c; padding:0.75rem; border-radius:0.5rem; font-size:0.875rem;">
                    <ul id="initFormErrorList" class="list-disc list-inside space-y-1"></ul>
                </div>
                <div style="background:#f0fdf4; padding:0.75rem; border-radius:0.5rem; border:1px solid #dcfce7;">
                    <label
                        style="display:block; font-size:0.875rem; font-weight:700; color:#166534; margin-bottom:0.25rem;">×§×¨×™××ª
                        ××•× ×” - ×“×™×¨×” ×¢×œ×™×•× ×”</label>
                    <input type="number" id="initTopInput" required class="input-field" placeholder="×œ××©×œ: 45468">
                </div>
                <div style="background:#eff6ff; padding:0.75rem; border-radius:0.5rem; border:1px solid #dbeafe;">
                    <label
                        style="display:block; font-size:0.875rem; font-weight:700; color:#1e40af; margin-bottom:0.25rem;">×§×¨×™××ª
                        ××•× ×” - ×“×™×¨×” ×ª×—×ª×•× ×”</label>
                    <input type="number" id="initBottomInput" required class="input-field" placeholder="×œ××©×œ: 61189">
                </div>
                <div style="display:flex; gap:0.75rem; padding-top:0.5rem;">
                    <button type="submit" class="btn"
                        style="flex:1; background:#eab308; color:#fff; padding:0.75rem; font-size:1rem; box-shadow:0 4px 6px -1px rgba(0,0,0,.1);">
                        ×©××•×¨ ×•×”××©×š
                    </button>
                    <button type="button" onclick="closeInitReadingsModal()"
                        style="padding:0.75rem 1rem; border-radius:0.5rem; border:1px solid #d1d5db; background:#fff; color:#4b5563;">
                        ×‘×™×˜×•×œ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // â”€â”€â”€â”€â”€ State â”€â”€â”€â”€â”€
        let bills = [];
        let initialSettings = { top: null, bottom: null };
        let editingBillId = null;

        // â”€â”€â”€â”€â”€ Init â”€â”€â”€â”€â”€
        document.addEventListener('DOMContentLoaded', () => {
            const savedBills = localStorage.getItem('elecBills');
            const savedSettings = localStorage.getItem('elecSettings');
            if (savedBills) bills = JSON.parse(savedBills);
            if (savedSettings) initialSettings = JSON.parse(savedSettings);
            bills.sort((a, b) => new Date(a.date) - new Date(b.date));
            renderSettings();
            renderBills();
            updateInitBanner();
        });

        // â”€â”€â”€â”€â”€ Settings â”€â”€â”€â”€â”€
        function toggleSettings() {
            document.getElementById('settingsPanel').classList.toggle('hidden');
        }

        function saveSettings() {
            const topVal = document.getElementById('initReadingTop').value;
            const bottomVal = document.getElementById('initReadingBottom').value;
            if (topVal) initialSettings.top = parseFloat(topVal);
            if (bottomVal) initialSettings.bottom = parseFloat(bottomVal);
            localStorage.setItem('elecSettings', JSON.stringify(initialSettings));
            renderBills();
            alert('×”×’×“×¨×•×ª × ×©××¨×• ×‘×”×¦×œ×—×”');
        }

        function renderSettings() {
            document.getElementById('initReadingTop').value = initialSettings.top ?? '';
            document.getElementById('initReadingBottom').value = initialSettings.bottom ?? '';
        }

        function resetAllData() {
            if (confirm('××–×”×¨×”: ×¤×¢×•×œ×” ×–×• ×ª××—×§ ××ª ×›×œ ×”×—×©×‘×•× ×•×ª ×•××ª ×›×œ ×”×”×’×“×¨×•×ª ××”××›×©×™×¨ ×”×–×”.\n×”×× ××ª/×” ×‘×˜×•×—/×”?')) {
                if (confirm('×”×× ××ª×” ×‘×××ª ×‘×˜×•×—? ×”× ×ª×•× ×™× ×™×™××—×§×• ×•×œ× × ×™×ª×Ÿ ×™×”×™×” ×œ×©×—×–×¨ ××•×ª×.')) {
                    localStorage.removeItem('elecBills');
                    localStorage.removeItem('elecSettings');
                    bills = [];
                    initialSettings = { top: null, bottom: null };
                    renderSettings();
                    renderBills();
                    updateInitBanner();
                    alert('×›×œ ×”× ×ª×•× ×™× × ××—×§×• ×‘×”×¦×œ×—×”.');
                }
            }
        }

        function hasInitialReadings() {
            return initialSettings.top !== null && initialSettings.bottom !== null;
        }

        function updateInitBanner() {
            const banner = document.getElementById('initReadingsBanner');
            if (!hasInitialReadings() && bills.length === 0) {
                banner.classList.remove('hidden');
            } else {
                banner.classList.add('hidden');
            }
        }

        // â”€â”€â”€â”€â”€ Initial Readings Modal â”€â”€â”€â”€â”€
        function openInitReadingsModal() {
            document.getElementById('initReadingsModal').classList.remove('hidden');
            document.getElementById('initFormErrors').classList.add('hidden');
            document.getElementById('initTopInput').value = '';
            document.getElementById('initBottomInput').value = '';
        }

        function closeInitReadingsModal() {
            document.getElementById('initReadingsModal').classList.add('hidden');
        }

        function handleInitReadingsSubmit(e) {
            e.preventDefault();
            const topVal = parseFloat(document.getElementById('initTopInput').value);
            const bottomVal = parseFloat(document.getElementById('initBottomInput').value);
            const errors = [];

            if (isNaN(topVal)) errors.push('×™×© ×œ×”×–×™×Ÿ ×§×¨×™××ª ××•× ×” ×¢×œ×™×•× ×”.');
            if (isNaN(bottomVal)) errors.push('×™×© ×œ×”×–×™×Ÿ ×§×¨×™××ª ××•× ×” ×ª×—×ª×•× ×”.');

            if (errors.length > 0) {
                const container = document.getElementById('initFormErrors');
                const list = document.getElementById('initFormErrorList');
                list.innerHTML = errors.map(e => `<li>${e}</li>`).join('');
                container.classList.remove('hidden');
                return;
            }

            initialSettings.top = topVal;
            initialSettings.bottom = bottomVal;
            localStorage.setItem('elecSettings', JSON.stringify(initialSettings));
            renderSettings();
            closeInitReadingsModal();
            updateInitBanner();
            openModal();
        }

        // â”€â”€â”€â”€â”€ Modal (Add / Edit) â”€â”€â”€â”€â”€
        function openModal(billId = null) {
            if (!billId && !hasInitialReadings()) {
                openInitReadingsModal();
                return;
            }
            document.getElementById('billModal').classList.remove('hidden');
            hideFormErrors();
            const modalTitle = document.getElementById('modalTitle');

            let prevTop = initialSettings.top;
            let prevBottom = initialSettings.bottom;

            if (billId) {
                editingBillId = billId;
                modalTitle.innerText = "×¢×¨×™×›×ª ×—×©×‘×•×Ÿ";
                const bill = bills.find(b => b.id === billId);
                document.getElementById('billDate').value = bill.date;
                document.getElementById('mainAmount').value = bill.main.amount;
                document.getElementById('mainKwh').value = bill.main.kwh;
                document.getElementById('readingTop').value = bill.readings.top;
                document.getElementById('readingBottom').value = bill.readings.bottom;

                const idx = bills.findIndex(b => b.id === billId);
                if (idx > 0) {
                    prevTop = bills[idx - 1].readings.top;
                    prevBottom = bills[idx - 1].readings.bottom;
                }
            } else {
                editingBillId = null;
                modalTitle.innerText = "×”×•×¡×¤×ª ×—×©×‘×•×Ÿ ×—×“×©";
                document.getElementById('billDate').valueAsDate = new Date();
                document.getElementById('mainAmount').value = '';
                document.getElementById('mainKwh').value = '';
                document.getElementById('readingTop').value = '';
                document.getElementById('readingBottom').value = '';

                if (bills.length > 0) {
                    const last = bills[bills.length - 1];
                    prevTop = last.readings.top;
                    prevBottom = last.readings.bottom;
                }
            }

            document.getElementById('prevTopDisplay').innerText = prevTop;
            document.getElementById('prevBottomDisplay').innerText = prevBottom;
        }

        function closeModal() {
            document.getElementById('billModal').classList.add('hidden');
            editingBillId = null;
        }

        // â”€â”€â”€â”€â”€ Validation â”€â”€â”€â”€â”€
        function validateForm(formDate, formAmount, formKwh, formTop, formBottom) {
            const errors = [];
            let prevTop = initialSettings.top;
            let prevBottom = initialSettings.bottom;

            if (editingBillId) {
                const idx = bills.findIndex(b => b.id === editingBillId);
                if (idx > 0) {
                    prevTop = bills[idx - 1].readings.top;
                    prevBottom = bills[idx - 1].readings.bottom;
                }
            } else {
                if (bills.length > 0) {
                    const last = bills[bills.length - 1];
                    prevTop = last.readings.top;
                    prevBottom = last.readings.bottom;
                }
            }

            if (!formKwh || formKwh <= 0) {
                errors.push('×¦×¨×™×›×” ×›×œ×œ×™×ª (×§×•×˜"×©) ×—×™×™×‘×ª ×œ×”×™×•×ª ×’×“×•×œ×” ×-0.');
            }
            if (!formAmount || formAmount <= 0) {
                errors.push('×¡×›×•× ×œ×ª×©×œ×•× ×—×™×™×‘ ×œ×”×™×•×ª ×’×“×•×œ ×-0.');
            }
            if (formTop < prevTop) {
                errors.push(`×§×¨×™××ª ××•× ×” ×¢×œ×™×•× ×” (${formTop}) ×§×˜× ×” ××”×§×¨×™××” ×”×§×•×“××ª (${prevTop}). ×¦×¨×™×›×” ×©×œ×™×œ×™×ª ××™× ×” ××¤×©×¨×™×ª.`);
            }
            if (formBottom < prevBottom) {
                errors.push(`×§×¨×™××ª ××•× ×” ×ª×—×ª×•× ×” (${formBottom}) ×§×˜× ×” ××”×§×¨×™××” ×”×§×•×“××ª (${prevBottom}). ×¦×¨×™×›×” ×©×œ×™×œ×™×ª ××™× ×” ××¤×©×¨×™×ª.`);
            }
            const totalTenants = (formTop - prevTop) + (formBottom - prevBottom);
            if (formKwh > 0 && totalTenants > formKwh) {
                errors.push(`×¡×š ×¦×¨×™×›×ª ×”×“×™×¨×•×ª (${totalTenants} ×§×•×˜"×©) ×¢×•×œ×” ×¢×œ ×”×¦×¨×™×›×” ×”×›×œ×œ×™×ª (${formKwh} ×§×•×˜"×©). ×‘×“×§×™ ××ª ×”× ×ª×•× ×™×.`);
            }
            return errors;
        }

        function showFormErrors(errors) {
            const container = document.getElementById('formErrors');
            const list = document.getElementById('formErrorList');
            list.innerHTML = errors.map(e => `<li>${e}</li>`).join('');
            container.classList.remove('hidden');
        }

        function hideFormErrors() {
            document.getElementById('formErrors').classList.add('hidden');
        }

        // â”€â”€â”€â”€â”€ Form Submit â”€â”€â”€â”€â”€
        function handleFormSubmit(e) {
            e.preventDefault();
            const formDate = document.getElementById('billDate').value;
            const formAmount = parseFloat(document.getElementById('mainAmount').value);
            const formKwh = parseFloat(document.getElementById('mainKwh').value);
            const formTop = parseFloat(document.getElementById('readingTop').value);
            const formBottom = parseFloat(document.getElementById('readingBottom').value);

            const errors = validateForm(formDate, formAmount, formKwh, formTop, formBottom);
            if (errors.length > 0) { showFormErrors(errors); return; }
            hideFormErrors();

            if (editingBillId) {
                bills = bills.map(b => {
                    if (b.id === editingBillId) {
                        return { ...b, date: formDate, main: { amount: formAmount, kwh: formKwh }, readings: { top: formTop, bottom: formBottom } };
                    }
                    return b;
                });
            } else {
                bills.push({
                    id: Date.now() + Math.random(),
                    date: formDate,
                    main: { amount: formAmount, kwh: formKwh },
                    readings: { top: formTop, bottom: formBottom }
                });
            }

            bills.sort((a, b) => new Date(a.date) - new Date(b.date));
            saveData();
            closeModal();
            renderBills();
        }

        function deleteBill(id) {
            if (confirm('×”×× ××ª ×‘×˜×•×—×” ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ×©×•×¨×” ×–×•?')) {
                bills = bills.filter(b => b.id !== id);
                saveData();
                renderBills();
            }
        }

        function saveData() {
            localStorage.setItem('elecBills', JSON.stringify(bills));
        }

        // â”€â”€â”€â”€â”€ CSV Export â”€â”€â”€â”€â”€
        function exportToCSV() {
            if (bills.length === 0) { alert("××™×Ÿ × ×ª×•× ×™× ×œ×™×™×¦×•×"); return; }
            let csv = "\uFEFF";
            csv += "×ª××¨×™×š,×—×©×‘×•×Ÿ ×¨××©×™ - ×¡×›×•×,×—×©×‘×•×Ÿ ×¨××©×™ - ×§×•×˜×©,×“×™×¨×” ×¢×œ×™×•× ×” - ×§×¨×™××”,×“×™×¨×” ×¢×œ×™×•× ×” - ×¦×¨×™×›×”,×“×™×¨×” ×¢×œ×™×•× ×” - ×œ×ª×©×œ×•×,×“×™×¨×” ×ª×—×ª×•× ×” - ×§×¨×™××”,×“×™×¨×” ×ª×—×ª×•× ×” - ×¦×¨×™×›×”,×“×™×¨×” ×ª×—×ª×•× ×” - ×œ×ª×©×œ×•×,×¨×›×•×© ××©×•×ª×£ - ×§×•×˜×©,×¨×›×•×© ××©×•×ª×£ - ×œ×ª×©×œ×•×\n";
            let prevTop = initialSettings.top;
            let prevBottom = initialSettings.bottom;
            bills.forEach(bill => {
                const rate = bill.main.kwh > 0 ? bill.main.amount / bill.main.kwh : 0;
                const consTop = bill.readings.top - prevTop;
                const consBottom = bill.readings.bottom - prevBottom;
                const payTop = consTop * rate;
                const payBottom = consBottom * rate;
                const commonKwh = bill.main.kwh - (consTop + consBottom);
                const commonPay = commonKwh * rate;
                csv += [bill.date, bill.main.amount, bill.main.kwh, bill.readings.top, consTop, payTop.toFixed(2), bill.readings.bottom, consBottom, payBottom.toFixed(2), commonKwh, commonPay.toFixed(2)].join(",") + "\n";
                prevTop = bill.readings.top;
                prevBottom = bill.readings.bottom;
            });
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "electricity_data.csv";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // â”€â”€â”€â”€â”€ CSV Import â”€â”€â”€â”€â”€
        function importFromCSV(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function (e) {
                try {
                    const text = e.target.result.replace(/^\uFEFF/, '');
                    const lines = text.split('\n').filter(l => l.trim() !== '');
                    if (lines.length < 2) { alert('×”×§×•×‘×¥ ×¨×™×§ ××• ×œ× ×ª×§×™×Ÿ.'); return; }
                    const dataLines = lines.slice(1);
                    let imported = 0, skipped = 0;
                    dataLines.forEach(line => {
                        const cols = line.split(',');
                        if (cols.length < 9) { skipped++; return; }
                        const date = cols[0].trim();
                        const amount = parseFloat(cols[1]);
                        const kwh = parseFloat(cols[2]);
                        const readingTop = parseFloat(cols[3]);
                        const readingBottom = parseFloat(cols[6]);
                        if (!date || isNaN(amount) || isNaN(kwh) || isNaN(readingTop) || isNaN(readingBottom)) { skipped++; return; }
                        if (bills.some(b => b.date === date)) { skipped++; return; }
                        bills.push({ id: Date.now() + Math.random(), date, main: { amount, kwh }, readings: { top: readingTop, bottom: readingBottom } });
                        imported++;
                    });
                    bills.sort((a, b) => new Date(a.date) - new Date(b.date));
                    saveData();
                    renderBills();
                    alert(`×™×™×‘×•× ×”×•×©×œ×: ${imported} ×—×©×‘×•× ×•×ª ×™×•×‘××•, ${skipped} ×©×•×¨×•×ª ×“×•×œ×’×•.`);
                } catch (err) { alert('×©×’×™××” ×‘×§×¨×™××ª ×”×§×•×‘×¥: ' + err.message); }
            };
            reader.readAsText(file, 'UTF-8');
            event.target.value = '';
        }

        // â”€â”€â”€â”€â”€ Render Bills â”€â”€â”€â”€â”€
        function renderBills() {
            const container = document.getElementById('billsList');
            const emptyState = document.getElementById('emptyState');
            container.innerHTML = '';

            if (bills.length === 0) { emptyState.classList.remove('hidden'); return; }
            emptyState.classList.add('hidden');

            let prevTop = initialSettings.top;
            let prevBottom = initialSettings.bottom;

            bills.forEach((bill) => {
                const rate = bill.main.kwh > 0 ? bill.main.amount / bill.main.kwh : 0;
                const consTop = bill.readings.top - prevTop;
                const consBottom = bill.readings.bottom - prevBottom;
                const payTop = consTop * rate;
                const payBottom = consBottom * rate;
                const commonKwh = bill.main.kwh - (consTop + consBottom);
                const commonPay = commonKwh * rate;

                const dateObj = new Date(bill.date);
                const dateStr = dateObj.toLocaleDateString('he-IL', { day: 'numeric', month: 'long', year: 'numeric' });
                const hasWarning = consTop < 0 || consBottom < 0 || commonKwh < 0;

                const commonBg = commonKwh < 0 ? '#fef2f2' : '#fff7ed';
                const commonBorder = commonKwh < 0 ? '#fecaca' : '#fed7aa';
                const commonLabelBg = commonKwh < 0 ? '#dc2626' : '#f97316';
                const commonText = commonKwh < 0 ? '#991b1b' : '#9a3412';
                const commonTextLight = commonKwh < 0 ? '#dc2626' : '#ea580c';

                const card = document.createElement('div');
                card.className = 'bill-card';
                card.innerHTML = `
                    <div style="background:#f3f4f6; padding:0.75rem; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #e5e7eb;">
                        <span style="font-weight:700; color:#374151;">${dateStr}</span>
                        <div style="display:flex; gap:0.5rem;">
                            <button onclick="openModal(${bill.id})" style="background:#fff; color:#3b82f6; font-size:0.875rem; display:flex; align-items:center; gap:0.25rem; padding:0.25rem 0.5rem; border-radius:0.25rem; border:1px solid #bfdbfe;">
                                âœï¸ ×¢×¨×™×›×”
                            </button>
                            <button onclick="deleteBill(${bill.id})" style="background:#fff; color:#f87171; font-size:0.875rem; padding:0.25rem 0.5rem; border-radius:0.25rem; border:1px solid #fee2e2;">
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    </div>

                    ${hasWarning ? `
                    <div style="background:#fefce8; border-bottom:1px solid #fef08a; padding:0.5rem 1rem; font-size:0.75rem; color:#854d0e; display:flex; align-items:center; gap:0.25rem;">
                        âš ï¸ <span>×¢×¨×›×™× ×—×¨×™×’×™× â€” ×‘×“×§×™ ××ª ×”×§×¨×™××•×ª.</span>
                    </div>` : ''}

                    <div style="padding:1rem;">
                        <!-- Summary Row -->
                        <div style="display:flex; justify-content:space-between; margin-bottom:1rem; font-size:0.875rem; background:#f9fafb; padding:0.5rem; border-radius:0.25rem;">
                            <div style="text-align:center;">
                                <div style="color:#6b7280; font-size:0.75rem;">×ª×¢×¨×™×£ ×œ×§×•×˜"×©</div>
                                <div style="font-weight:700;">${rate.toFixed(4)} â‚ª</div>
                            </div>
                            <div style="text-align:center; border-right:1px solid #e5e7eb; border-left:1px solid #e5e7eb; padding:0 0.5rem;">
                                <div style="color:#6b7280; font-size:0.75rem;">×¡×”"×› ×—×©×‘×•×Ÿ</div>
                                <div style="font-weight:700;">${bill.main.amount.toFixed(2)} â‚ª</div>
                            </div>
                            <div style="text-align:center;">
                                <div style="color:#6b7280; font-size:0.75rem;">×¦×¨×™×›×” ×›×œ×œ×™×ª</div>
                                <div style="font-weight:700;">${bill.main.kwh} ×§×•×˜"×©</div>
                            </div>
                        </div>

                        <!-- Tenants Grid -->
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:1rem; margin-bottom:1rem;">
                            <!-- Top Tenant -->
                            <div class="tenant-card" style="border-color:#bbf7d0; background:#f0fdf4;">
                                <div class="tenant-label" style="background:#16a34a;">×¢×œ×™×•× ×”</div>
                                <div style="margin-top:0.5rem; text-align:center;">
                                    <span style="display:block; font-size:1.5rem; font-weight:700; color:#166534;">${payTop.toFixed(2)} â‚ª</span>
                                    <span style="font-size:0.75rem; color:#15803d;">×œ×ª×©×œ×•×</span>
                                </div>
                                <div style="margin-top:0.75rem; font-size:0.75rem; color:#166534; display:flex; justify-content:space-between; border-top:1px solid #bbf7d0; padding-top:0.5rem;">
                                    <span>×¦×¨×™×›×”: <b>${consTop}</b></span>
                                    <span>×§×¨×™××”: ${bill.readings.top}</span>
                                </div>
                            </div>

                            <!-- Bottom Tenant -->
                            <div class="tenant-card" style="border-color:#bfdbfe; background:#eff6ff;">
                                <div class="tenant-label" style="background:#2563eb;">×ª×—×ª×•× ×”</div>
                                <div style="margin-top:0.5rem; text-align:center;">
                                    <span style="display:block; font-size:1.5rem; font-weight:700; color:#1e40af;">${payBottom.toFixed(2)} â‚ª</span>
                                    <span style="font-size:0.75rem; color:#1d4ed8;">×œ×ª×©×œ×•×</span>
                                </div>
                                <div style="margin-top:0.75rem; font-size:0.75rem; color:#1e40af; display:flex; justify-content:space-between; border-top:1px solid #bfdbfe; padding-top:0.5rem;">
                                    <span>×¦×¨×™×›×”: <b>${consBottom}</b></span>
                                    <span>×§×¨×™××”: ${bill.readings.bottom}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Common Area -->
                        <div class="tenant-card" style="border-color:${commonBorder}; background:${commonBg};">
                            <div class="tenant-label" style="background:${commonLabelBg};">×¨×›×•×© ××©×•×ª×£</div>
                            <div style="margin-top:0.5rem; display:flex; justify-content:space-between; align-items:center;">
                                <div style="text-align:center; flex:1;">
                                    <span style="display:block; font-size:1.125rem; font-weight:700; color:${commonText};">${commonKwh} ×§×•×˜"×©</span>
                                    <span style="font-size:0.75rem; color:${commonTextLight};">×¦×¨×™×›×” ××©×•×ª×¤×ª</span>
                                </div>
                                <div style="text-align:center; flex:1; border-right:1px solid ${commonBorder}; padding-right:0.75rem;">
                                    <span style="display:block; font-size:1.125rem; font-weight:700; color:${commonText};">${commonPay.toFixed(2)} â‚ª</span>
                                    <span style="font-size:0.75rem; color:${commonTextLight};">×¢×œ×•×ª</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                container.appendChild(card);
                prevTop = bill.readings.top;
                prevBottom = bill.readings.bottom;
            });
        }
    </script>
</body>

</html>